pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
#include containers.lua
#include mouse.lua
#include mines.lua

function _init()
    -- enables the mouse during gameplay
    poke(0x5f2d, 1)
    initMouseX = 0
    initMouseY = 0
end

function _update60()
    mineInteraction()
    spawnGreyMines()
    spawnBlueMines()
    spawnRedMines()
    gameFrameCount += 1
end

function _draw()
    cls()
    foreach(mineList, drawMines)
    
    if mouse.dragging and not mouse.clickedSingle then
    	rect(initMouseX, initMouseY, mouse.x, mouse.y, 7)
        spr(mouse.sprClick, mouse.x - 1, mouse.y)
    else
        spr(mouse.sprNormal, mouse.x - 1, mouse.y)
    end

    local selectedCount = 0
    for m in all(mineList) do
        if m.selected then selectedCount += 1 end
    end

    print("mines selected", 6, 6, 6)
    print(selectedCount, 6, 16, 6)
    print(gameFrameCount, 6, 26, 6 )
end

__gfx__
0000000001100000077000000000000000000000000000000000000000000000000000000dddddd0000000000111111000000000022222200000000000000000
00000000017100000717000006000060060000600c0000c00c0000c00800008008000080d666666d000000001cccccc100000000288888820000000000000000
007007000177100007117000006dd600006dd60000c11c0000c11c000082280000822800ddddddddd000000d1111111110000001222222222000000200000000
00077000017771000711170000d66d0000d66d00001cc100001cc1000028820000288200d66dd66dd660066d1cc11cc11cc00cc1288228822880088200000000
00077000017777100711117000d66d0005566d00001cc100055cc1000028820005588200d666666dd666666d1cccccc11cccccc1288888822888888200000000
007007000177110007117700006dd6005775d60000c11c0057751c000082280057752800d666666dd666666d1cccccc11cccccc1288888822888888200000000
00000000001171000077170006000060577500600c0000c0577500c00800008057750080d666666dd666666d1cccccc11cccccc1288888822888888200000000
0000000000000000000000000000000005500000000000000550000000000000055000000dddddd00dddddd00111111001111110022222200222222000000000
